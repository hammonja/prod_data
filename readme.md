#Boms

#####overivew

Idea is to use github to store the history for the BOMs and track the issues and reasons.  
All boms exist in sage and in git. The two should always match. Ideally we would have git, as the version controlled one, be the master.  
However since editing BOMs outside of Sage is painful and Sage is the system that actually builds things it has to be the master.  
Therefore all the BOMs are in sage. GIT has a copy and it routinely checks to see that the two are the same. If they are not it sends a warning email.

#####usage
A user of the system should :
 1. decided they need to change a bom
 2. fill out a CRM form and get it authorized , this will be a issue in the repo with a fixed format [CRM_Issue_Template.txt](CRM_Issue_Template.txt). Issue Title should be the name of the BOM
 3. update the issue with what action was to be taken
 3. effect the changes in sage
 4. run [update_git_bom.py](scripts/update_git_bom.py) , this will extract the bom from sage and update the users GIT folder.
 5. commit the change with a reference to the issue. Comment should be <bom name><issue number> i.e. DH_SI #2

#####How it works
For Each Bom there is a GIT folder. In each folder there will be
 * a readme.md containing a table of the bom for viewing on the web
 * a json object for the bom
 * a sage bom file for importing into sage

The above structure is to be generated by a python script called [sage_bom_export.py](scripts/sage_bom_export.py). This script is used during the installation only.

Then running on a schedule every 15 minutes [bom_check.py](scripts/bom_check.py) will be run.

The script performs the follow actions.

 1. enumerates all the json bom objects to produce a single git_bom json object.
 2. queries the Sage database to produce a sage_bom json object.
 3. compares the objects , if equal then **STOP**
 4. if not equal , work out which boms have changed and update the working folders for these boms from git
 5. rebuild git_boms json then compare it again to sage_boms json object , if equal then **STOP**
 6. if not equal send an email stating BOM : <name> is out sync with source control.

#####future work
1. if possible track WO built using each version of the BOMs
2. need to check that the bom imports work , there will be issues around the funny characters. 
